<!DOCTYPE html>
<html lang="en">
  <head>
	  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Particle Brightness Estimator</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap-4.4.1.css" rel="stylesheet">
	<link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />

	
	<!-- Chart library -->
	<script
	src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
	</script>


	<script src="PIV_MieScattering/ComplexNumber.js" type="text/javascript"></script>
	<script src="PIV_MieScattering/ComplexTrig.js" type="text/javascript"></script>
	<script src="PIV_MieScattering/bhmie.js" type="text/javascript"></script>	  
	  
	<style type="text/css">
      
		td {
		   text-align: left;
		}
		body { background-color: #F8F8F8; } 
		
		table {
            border-collapse: collapse;
        }
		
		/* Style the tab */
		.tab {
		  overflow: hidden;
		  border: 1px solid #ccc;
		  background-color: #f1f1f1;
		}		
		
		/* Style the buttons inside the tab */
		.tab button {
		  background-color: inherit;
		  float: left;
		  border: none;
		  outline: none;
		  cursor: pointer;
		  padding: 14px 16px;
		  transition: 0.3s;
		  font-size: 17px;
		}

		/* Change background color of buttons on hover */
		.tab button:hover {
		  background-color: #ddd;
		}

		/* Create an active/current tablink class */
		.tab button.active {
		  background-color: #ccc;
		}

		/* Style the tab content */
		.tabcontent {
		  display: none;
		  padding: 6px 12px;
		  border: 1px solid #ccc;
		  border-top: none;
		}
		.tabcontent {
		  animation: fadeEffect 1s; /* Fading effect takes 1 second */
		}
		
		/* Go from zero to full opacity */
		@keyframes fadeEffect {
		  from {opacity: 0;}
		  to {opacity: 1;}
		}
    </style>
	  
	  
	  
  </head>
  <body onload="init();">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="#">Menu</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="http:\\zigunov.com">Back to zigunov.com <span class="sr-only">(current)</span></a>
          </li>
		  <li class="nav-item active">
		  <a class="nav-link" href="https://zigunov.com/2023/06/30/how-bright-are-my-piv-particles/">Back to PIV post <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html">Other Projects</a>
          </li>
          <li class="nav-item">
            <li><a  class="nav-link" href="#">         </a></li> 
          </li>		
          <li class="nav-item">
            <a class="nav-link"  href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2F3dfernando.github.io%2FPIV_ISOSpeed.html&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=Visits&edge_flat=false"/></a>
          </li>
          <li class="nav-item dropdown"> </li>
        </ul>
</div>
    </nav>
	  <div style="clear: left;"></div>    
		<div style="clear: left;"></div>
		<h2><b>How bright are my PIV particles?</b></h2>
        <h6>This little calculator allows an estimate of the brightness of small particles illuminated by laser light, as seen by a camera with a rated ISO or a rated amp gain/quantum efficiency. <br> See 
		    <a href="http:\\zigunov.com\?p=3411">PIV post</span></a> for more details on how each method calculates the saturation exposure.</h6>
        <h6>Values in <b>bold</b> are inputs.</h6>
	<br><br>
<table style="width:75%; margin-left: 10px;">
<tr><td style="width:50%">

	<div class="tab">
	  <button class="tablinks" onclick="openTab(event, 'ISO')" id="defaultOpen">Known Camera ISO</button>
	  <button class="tablinks" onclick="openTab(event, 'Quantum')">Known Quantum Efficiency</button>
	  <button class="tablinks" onclick="openTab(event, 'SatPhotons')">Input Sat. Photons Directly</button>
	</div>

	<!-- Tab content -->
	<div id="ISO" class="tabcontent">	  
	  <table>
			<tr style="border-top: 1px solid black; color: blue;">
				<td span=2><b>Saturation Photons Calculation - Known Camera ISO</b> <td>
		  </tr>  
		  <tr>
			<td ><b>ISO Film Speed or EI (S)</b> <td><input type="text" id="ISOtext" name="ISOtext" value="1600" onchange="Recalculate()" title="Rated ISO film speed. Note that some manufacturers rate their cameras rate based on the maximum film speed in their datasheets, but at those film speeds the noise is very large. &#013; &#013; Also see original PIV post (link in navbar) regarding rated ISO vs actual ISO for cameras I had access to."></td>
		  </tr>  
		  <tr>
			<td>Exposure for 18% gray (H<sub>18</sub>) [lux-s] <td><input type="text" id="H18" name="H18" disabled="disabled"></td>
		  </tr>
		  <tr>
			<td>Exposure for 100% gray (H<sub>100</sub>) [lux-s] <td><input type="text" id="H100" name="H100" disabled="disabled"></td>
		  </tr>
		  <tr>
			<td><b>Wavelength (λ) [nm]</b> <td><input type="text" id="lambda" name="lambda" value="532" onchange="Recalculate()"  title="Wavelength of incoming monochromatic light. This calculator doesn't support white or wide-spectrum light."></td>
		  </tr>  
		  <tr>
			<td>Photon energy (ε<sub>ph</sub>) [J] <td><input type="text" id="photonEnergy" name="photonEnergy" disabled="disabled" title="This is the energy of a single photon from the Planck-Einstein relation."></td>
		  </tr>
		  <tr>
			<td>Photopic luminous efficiency V(λ) <td><input type="text" id="phEff" name="phEff" disabled="disabled"   title="To convert from lumens to Watts"></td>
		  </tr>
		  <tr>
			<td>Saturation exposure energy per pixel (h<sub>100,e</sub>) [J] <td><input type="text" id="H100e" name="H100e" disabled="disabled"></td>
		  </tr>
		  <tr>
			<td>Saturation exposure energy per pixel (h<sub>100,ph</sub>) [photons] <td><input type="text" id="H100ph" name="H100ph" disabled="disabled" title="Number of photons required to saturate the pixel under these conditions."></td>
		  </tr>
	  </table>
	  
	</div>

	<div id="Quantum" class="tabcontent">
	  <table>
			<tr style="border-top: 1px solid black; color: blue;">
				<td span=2><b>Saturation Photons Calculation - Known Quantum Efficiency</b> <td>
		  </tr>  		  
		  <tr>
			<td><b>Wavelength (λ) [nm]</b> <td><input type="text" id="lambdaQE" name="lambdaQE" value="532" onchange="Recalculate()"  title="Wavelength of incoming monochromatic light. This calculator doesn't support white or wide-spectrum light."></td>
		  </tr>  
		  <tr>
			<td>Photon energy (ε<sub>ph</sub>) [J] <td><input type="text" id="photonEnergyQE" name="photonEnergyQE" disabled="disabled" title="This is the energy of a single photon from the Planck-Einstein relation."></td>
		  </tr>		  
		  <tr>
			<td><b>Sensor quantum efficiency [%]</b> <td><input type="text" id="qeff" name="qeff" value="70" onchange="Recalculate()"  title="Quantum efficiency of the sensor at the given wavelength (from sensor datasheet). Given in electrons per photon (say 70% Q.E. means every 100 photons produce 70 electrons of signal in the pixel)"></td>
		  </tr> 		  	  
		  <tr>
			<td><b>Saturation electrons</b> <td><input type="text" id="eSat" name="eSat" value="40000" onchange="Recalculate()"  title="Number of electrons to saturate the pixel (from camera datasheet). Depends on both pixel design in the sensor (sometimes called well depth) and the amplifier gain in the camera circuits. Typical values about 40000 to 60000."></td>
		  </tr> 
		  
		  <tr>
			<td>Saturation exposure energy per pixel (h<sub>100,e</sub>) [J] <td><input type="text" id="H100e_QE" name="H100e_QE" disabled="disabled"></td>
		  </tr>
		  <tr>
			<td>Saturation exposure energy per pixel (h<sub>100,ph</sub>) [photons] <td><input type="text" id="H100ph_QE" name="H100ph_QE" disabled="disabled" title="Number of photons required to saturate the pixel under these conditions."></td>
		  </tr>
	  </table>		  
	</div>

	<div id="SatPhotons" class="tabcontent">
	  <table>
			<tr style="border-top: 1px solid black; color: blue;">
				<td span=2><b>Saturation Photons Inputted Directly</b> <td>
		  </tr> 
 		  
		  <tr>
			<td><b>Wavelength (λ) [nm]</b> <td><input type="text" id="lambda_Direct" name="lambda_Direct" value="532" onchange="Recalculate()"  title="Wavelength of incoming monochromatic light. This calculator doesn't support white or wide-spectrum light."></td>
		  </tr>  
		  <tr>
			<td>Photon energy (ε<sub>ph</sub>) [J] <td><input type="text" id="photonEnergy_Direct" name="photonEnergy_Direct" disabled="disabled" title="This is the energy of a single photon from the Planck-Einstein relation."></td>
		  </tr>	 
		  <tr>
			<td><b>Saturation exposure energy per pixel (h<sub>100,ph</sub>) [photons] <b><td><input type="text" id="H100ph_Direct" name="H100ph_Direct" onchange="Recalculate()" title="Number of photons required to saturate the pixel, directly provided by the user."></td>
		  </tr>	 
		  <tr>
			<td>Saturation exposure energy per pixel (h<sub>100,e</sub>) [J] <td><input type="text" id="H100e_Direct" name="H100e_Direct" disabled="disabled"></td>
		  </tr> 
	  </table>	
	</div>


<table>
  <tr style="border-top: 1px solid black; color: blue;">
    <td span=2><b>Camera Optics Setup</b> <td>
  </tr> 
  <tr>
	<td><b>Pixel size (w<sub>px</sub>) [μm]</b> <td><input type="text" id="pixelsize" name="pixelsize" value="5.5" onchange="Recalculate()" title="Assumes square pixels."></td>
  </tr>
  <tr>
	<td><b>Lens focal distance (f) [mm]</b> <td><input type="text" id="focaldist" name="focaldist" value="105" onchange="Recalculate()"></td>
  </tr>
  <tr>
	<td><b>Distance from particle to lens (i) [mm]</b> <td><input type="text" id="particledist" name="particledist" value="1000" onchange="Recalculate()" title="Distance to lens entrance pupil."></td>
  </tr>
  <tr>
	<td><b>Lens f-number (N)</b> <td><input type="text" id="fnumber" name="fnumber" value="5.6" onchange="Recalculate()"></td>
  </tr>
  
  <tr>
	<td><b>Gaussian particle image std. dev. [px]</b> <td><input type="text" id="fstd" name="fstd" value="1" onchange="Recalculate()" title="Particles typically don't focus on a single pixel due to aberrations on the lens. This is an empirical definition of particle image size. See on the right how the particle would look like. Adjust according to your experience with your problem."></td>
  </tr>
  <tr>
	<td><b>Camera view angle (0deg=looking at laser)</b> <td><input type="text" id="camAngle" name="camAngle" value="60" onchange="Recalculate()" title="Here we define the camera position to facilitate the interpretation of the curve plotted below. For this fixed angle (where 0deg=looking *at* the light source and 180deg=looking *from* the light source), we can compute the number of photons per pixel(last boxes below) and see the effect of the parameters for a fixed angle."></td>
  </tr>
  
  <tr style="border-top: 1px solid black; color: blue;">
    <td span=2><b>Illumination Parameters</b> <td>
  </tr>
  <tr>
    <td><b>Laser pulse energy (Q<sub>laser</sub>) [J]</b> <td><input type="text" id="Qlaser" name="Qlaser" value="0.2" onchange="Recalculate()" title="The light energy is all that matters. If you have a continuous light source, this is exposure time * power."></td>
  </tr>
  <tr>
    <td><b>Laser pulse time (t) [ns]</b> <td><input type="text" id="time" name="time" value="20" onchange="Recalculate()" title="The pulse time doesn't change any of the results. But it is an intermediary qty to convert between energy and power."></td>
  </tr>
  <tr>
    <td><b>Laser beam width (w<sub>beam</sub>) [mm]</b> <td><input type="text" id="wbeam" name="wbeam" value="2" onchange="Recalculate()" title="The width and length define the area the light spreads out at the location where the particle is."></td>
  </tr>
  <tr>
    <td><b>Laser beam length (l<sub>beam</sub>) [mm]</b> <td><input type="text" id="lbeam" name="lbeam" value="20" onchange="Recalculate()" title="The width and length define the area the light spreads out at the location where the particle is."></td>
  </tr>
  <tr>
    <td>Laser irradiance (E<sub>laser</sub>) [W/m<sup>2</sup>] <td><input type="text" id="irradiance" name="irradiance" disabled="disabled"></td>
  </tr>
  <tr>
    <td><b>Particle Radius (r) [μm]</b> <td><input type="text" id="particleradius" name="particleradius" value="5" onchange="Recalculate()" title="Particle RADIUS, not diameter!"></td>
  </tr>  
  <tr>
    <td><b>Particle IOR, real part (n<sub>Re</sub>)</b> <td><input type="text" id="IOR_Re" name="IOR_Re" value="1.333" onchange="Recalculate()" title="This is the index of refraction of the particle material, here assumed to be homogeneous. We currently don't support bubble-like (shell) particles."></td>
  </tr>  
  <tr>
    <td><b>Particle IOR, imaginary part (n<sub>Im</sub>)</b> <td><input type="text" id="IOR_Im" name="IOR_Im" value="0" onchange="Recalculate()" title="Extinction coefficient of the particle material."></td>
  </tr>  
  <tr>
    <td><b>Medium IOR (n<sub>medium, Re</sub>)</b> <td><input type="text" id="IOR_Medium" name="IOR_Medium" value="0" onchange="Recalculate()" title="Index of refraction of the medium, assumed to have extinction coefficient of zero."></td>
  </tr> 
  <tr>
    <td>Radiant flux emitted by particle (Φ<sub>e</sub>) [W] <td><input type="text" id="radflux" name="radflux" disabled="disabled"></td>
  </tr>  
  <tr>
    <td>Photons/pixel at the camera, perp. [photons] <td><input type="text" id="photonsPerPixelPerp" name="photonsPerPixelPerp" disabled="disabled" title="For the fixed camera view angle above, this is the number of photons registered in the brightest pixel for perpendicularly polarized light."></td>
  </tr>  
  <tr style="border-bottom: 1px solid black">
    <td>Photons/pixel at the camera, par. [photons] <td><input type="text" id="photonsPerPixelPar" name="photonsPerPixelPar" disabled="disabled" title="For the fixed camera view angle above, this is the number of photons registered in the brightest pixel for perpendicularly polarized light."></td>
  </tr> 
    
</table>
</td>
<td style="width:50%">
<table>
<tr> <td>  <img src="PIV_MieScattering/Schematic Diagram.png" width="500 px" align="left">  </td> </tr>
<tr> <td>  <br>  </td> </tr>
<tr> <td> <canvas id="PixelPlot"  width="300 px" height="325 px" align="left" style="display:block;"></canvas> </td> </tr>
</table>
</td>
</tr>
</table>
<br>

	<canvas id="ScatteringPlot" style="max-width:1200px"></canvas>
	<script src="PIV_MieScattering/MainFunction.js" type="text/javascript"></script>	


<br>


<div style="width:70%; margin-left:10px">
<h3><b>How do I know if my polarization is perpendicular or parallel?</b></h3>
<h6>It's very simple: use the plane in space formed by the three points: (1) light source, (2) particle and (3) camera; <u>or</u> the two vectors (A) incident light and (B) scattered light. If the electric field polarization vector is parallel to this plane, then use the "parallel" polarization curve. If it is perpendicular to the plane, then use the "perpendicular" polarization curve. Note that your laser light could be polarized at any arbitrary angle with respect to this plane, so the actual brightness will be somewhere in between these two numbers, in practice. See picture below for a graphical explanation.<h6>
</di> 

<table>
<tr> <td>  
<img src="PIV_MieScattering/Polarization Diagram.png" width="600px" align="left"/>
 </td> </tr>
</table>

	<br><br>
    
    <div class="footer">
            Copyright © Fernando Zigunov 2023. All rights reserved.
    </div>
	<br><br>
	<br><br>
	<br><br>
	
	
	
	<script>
		
		function openTab(evt, cityName) {
		  var i, tabcontent, tablinks;
		  tabcontent = document.getElementsByClassName("tabcontent");
		  for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		  }
		  tablinks = document.getElementsByClassName("tablinks");
		  for (i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
		  }
		  document.getElementById(cityName).style.display = "block";
		  evt.currentTarget.className += " active";
		  
		  Recalculate();
		}
		document.getElementById("defaultOpen").click();		
	</script>
	
	
	
	
	
	
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-3.4.1.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap-4.4.1.js"></script>
  </body>
</html>